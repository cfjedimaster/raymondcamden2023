
<div class="comment" id="c_1713745430">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745430">1</a> by Edward Rynearson
		posted on 4/1/2013 at 11:08 PM
		</div>
		<div class="comment_text"><p>TY</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745432">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745432">2</a> by Raymond Camden
		posted on 4/1/2013 at 11:10 PM
		</div>
		<div class="comment_text"><p>YW :)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745434">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745434">3</a> by Mario Rodrigues
		posted on 4/2/2013 at 1:21 AM
		</div>
		<div class="comment_text"><p>Great job on this Ray.  Looking forward to reviewing the rest of the series.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745436">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745436">4</a> by Richard
		posted on 4/2/2013 at 12:50 PM
		</div>
		<div class="comment_text"><p>great - just in time, I am working on a site that requires this stuff:)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745431">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745431">5</a> by Bob Clingan
		posted on 4/2/2013 at 7:49 PM
		</div>
		<div class="comment_text"><p>Thanks for writing this series.. there is a project I've been itching to start using a site that utilizes oauth and I found it difficult to get started.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745435">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745435">6</a> by Raymond Camden
		posted on 4/2/2013 at 7:53 PM
		</div>
		<div class="comment_text"><p>Part 2 was supposed to go live now, but I just blogged something else. It should be up around 4 though.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745439">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745439">7</a> by David Jennings
		posted on 4/2/2013 at 8:04 PM
		</div>
		<div class="comment_text"><p>Great tutorial, thanks a lot :)  I want connect this to database user - ie creating a registration form, is there any particular variable you would use to link the fb account to the database user? So they site can recognise them days later</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745438">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745438">8</a> by Raymond Camden
		posted on 4/2/2013 at 8:08 PM
		</div>
		<div class="comment_text"><p>Look at the result from the method called to get my own user details. It contains an ID. You could use that as a link to local tables. You may want to link it to username as well and ensure both match.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745440">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745440">9</a> by Chris Pilie
		posted on 4/3/2013 at 7:09 PM
		</div>
		<div class="comment_text"><p>wondering if you are watching my google search keywords... reading my mind! thanks Ray.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745442">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745442">10</a> by jeff horne
		posted on 4/4/2013 at 2:15 AM
		</div>
		<div class="comment_text"><p>Thanks.  This is great.  Looking forward to the rest of the series.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745453">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745453">11</a> by Balriam
		posted on 4/7/2013 at 2:49 PM
		</div>
		<div class="comment_text"><p>Thanks<br>looks too easy and any one can understand easly.</p><p>Thanks<br>Balriam</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745464">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745464">12</a> by Mike
		posted on 4/10/2013 at 1:46 AM
		</div>
		<div class="comment_text"><p>Hi Ray,</p><p>Thanks for this I have managed to hook it into my site perfectly for a facebook login.  One thing im struggling with though is getting it to work on my iphone (same script) it throws up an element state is undefined in session error.  any ideas what might be going on here?  beating my head off of my wall hasnt helped and has just made my mrs angry :)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745463">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745463">13</a> by Joseph Potthast
		posted on 4/10/2013 at 4:42 AM
		</div>
		<div class="comment_text"><p>Finally got a chance to sit down and try this code. Ray as always you're amazing in how you A) seem to be able to read my mind about what I want to research and B) always explain things in such a way that you make it look so easy. Great job as always and thanks.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745459">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745459">14</a> by Raymond Camden
		posted on 4/10/2013 at 4:32 PM
		</div>
		<div class="comment_text"><p>Mike, one issue a friend of mine ran into was using the wrong domain in the redir. By wrong I mean going from <a href="http://disq.us/url?url=http%3A%2F%2Fwww.foo.com%3AXyHzr9i_xV8Q_nGiigenJ6yZiHQ&amp;cuid=3321886" rel="nofollow noopener" title="www.foo.com">www.foo.com</a> to <a href="http://disq.us/url?url=http%3A%2F%2Ffoo.com%3AN7Z24oIKkMVc9eNBzSRQUSpuMJ0&amp;cuid=3321886" rel="nofollow noopener" title="foo.com">foo.com</a>. This caused the CF session to reset. Any chance that is happening to you? I assume not since you said it works ok outside of iPhone.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745460">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745460">15</a> by Mike Sharp
		posted on 4/10/2013 at 8:11 PM
		</div>
		<div class="comment_text"><p>As always Ray, you are a scholar and a gent!.</p><p>That I think may be it, my redirect wasn't maintaining the www. and so it was dropping the session prior to firing the user to Facebook.  forcing the www. seems to have resolved it nicely :)</p><p>Thanks!</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745462">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745462">16</a> by Steve
		posted on 4/17/2013 at 8:42 PM
		</div>
		<div class="comment_text"><p>Ray,</p><p>Thanks for the great post.  I'm completely new to working with the Facebook API, and between your tutorial and the Graph Explorer I've been able to quickly and easily start getting data out of fb.</p><p><a href="https://disq.us/url?url=https%3A%2F%2Fdevelopers.facebook.com%2Ftools%2Fexplorer%3Fmethod%3DGET%26path%3D1506660795%253Ffields%253Did%252Cname%3AJQUcV25nWU8scubFjzJ539bLtBg&amp;cuid=3321886" rel="nofollow noopener" title="https://developers.facebook.com/tools/explorer?method=GET&amp;path=1506660795%3Ffields%3Did%2Cname">https://developers.facebook...</a></p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745466">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745466">17</a> by Gilles
		posted on 4/17/2013 at 11:54 PM
		</div>
		<div class="comment_text"><p>Nice! Will you write one for Twitter too?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745465">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745465">18</a> by Raymond Camden
		posted on 4/18/2013 at 12:00 AM
		</div>
		<div class="comment_text"><p>Wasn't planning on it. ;)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745468">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745468">19</a> by Tomasz Mieczkowski
		posted on 4/22/2013 at 7:13 PM
		</div>
		<div class="comment_text"><p>Fantastic - I just grabbed Linked In - very clean code - no useless files - works like a charm.  I'll give this one a shot too.  Great work.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745469">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745469">20</a> by Gary F
		posted on 4/24/2013 at 6:30 AM
		</div>
		<div class="comment_text"><p>Thanks for the tutorial, Ray. It's taking between 4 and 6 seconds to execute the whole demo even when I run it again. Shouldn't it be taking about 1 sec? :-( BTW, when trying to submit a comment it kept telling me it's been marked as spam. I'm on my 12th revision...</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745471">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745471">21</a> by Raymond Camden
		posted on 4/24/2013 at 6:38 AM
		</div>
		<div class="comment_text"><p>Well, if you are logged in, the index.cfm page runs getMe and getFriends. Both of those are network requests that could be slow. You could wrap then with cftimer calls or just enabled debugging to verify. Typically you would cache those results and not rerun them every time.</p><p>Sorry about the spam blocker going overboard on you.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745474">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745474">22</a> by Nathan Blixt
		posted on 5/1/2013 at 5:21 PM
		</div>
		<div class="comment_text"><p>Works like a charm! However, what would be your method to automatically log in a user if their session expired but they're logged into Facebook? ...I might have found my answer: <a href="https://disq.us/url?url=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fhowtos%2Flogin%2Fgetting-started%2F%3APUFblivWH1Sh9wAkokP3MAIy4TA&amp;cuid=3321886" rel="nofollow noopener" title="https://developers.facebook.com/docs/howtos/login/getting-started/">https://developers.facebook...</a></p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745472">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745472">23</a> by Raymond Camden
		posted on 5/1/2013 at 5:36 PM
		</div>
		<div class="comment_text"><p>I believe if you autoforwarded them to the right link, they would auto bounce back.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745473">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745473">24</a> by Dave White
		posted on 5/6/2013 at 7:21 AM
		</div>
		<div class="comment_text"><p>For those that asked about Twitter Oauth I have put this together<br><a href="http://disq.us/url?url=http%3A%2F%2Fcfjquery.com%2Fblog%2Fpost.cfm%2Flogin-using-twitter-facebook-google-and-linkedin-part-2%3Agu9EUS3dELFqRbA9Sv_hghbyH4A&amp;cuid=3321886" rel="nofollow noopener" title="http://cfjquery.com/blog/post.cfm/login-using-twitter-facebook-google-and-linkedin-part-2">http://cfjquery.com/blog/po...</a></p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745475">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745475">25</a> by Miles Prunier
		posted on 5/9/2013 at 10:32 PM
		</div>
		<div class="comment_text"><p>Raymond, would you have any idea why index.cfm is throwing this error?<br>Could not find the ColdFusion Component or Interface facebook. <br>The error occurred in /web/<a href="http://disq.us/url?url=http%3A%2F%2Fcf.telegram.com%2Fhtml%2Ftest%2Ffb1%2Findex.cfm%3A%3AZf7tVeFqQydN6qphackP5aU5j80&amp;cuid=3321886" rel="nofollow noopener" title="cf.telegram.com/html/test/fb1/index.cfm:">cf.telegram.com/html/test/f...</a> line 13<br>13 : 	&lt;cfset session.fbAPI = createObject("component","facebook").init(session.fbaccesstoken)&gt;</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745478">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745478">26</a> by Raymond Camden
		posted on 5/10/2013 at 7:23 AM
		</div>
		<div class="comment_text"><p>It means it can't "see" the facebook CFC. Did you copy it?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745476">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745476">27</a> by Miles Prunier`
		posted on 5/10/2013 at 4:07 PM
		</div>
		<div class="comment_text"><p>The Application.cfc file is in the same directory as index.cfm and redir.cfm. (Is there also a facebook.cfc?)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745479">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745479">28</a> by Raymond Camden
		posted on 5/10/2013 at 6:50 PM
		</div>
		<div class="comment_text"><p>It is the last code sample above.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745480">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745480">29</a> by Miles Prunier
		posted on 5/10/2013 at 7:02 PM
		</div>
		<div class="comment_text"><p>Gotcha. Thanks! (I REALLY appreciate it!)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745481">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745481">30</a> by Seth Johnson
		posted on 5/31/2013 at 12:35 PM
		</div>
		<div class="comment_text"><p>Ray,</p><p>Thanks for the great start.  I tried to work through the example but I think the code for your redir.cfm code is missing.  Any chance you can repost?</p><p>Thanks,</p><p>Seth</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745482">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745482">31</a> by Raymond Camden
		posted on 6/1/2013 at 12:45 AM
		</div>
		<div class="comment_text"><p>The Gist that had the code borked out for some reason. I made a new Gist and replaced it above.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745484">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745484">32</a> by Seth Johnson
		posted on 6/1/2013 at 2:02 AM
		</div>
		<div class="comment_text"><p>Thanks Ray!</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745486">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745486">33</a> by Michael
		posted on 7/5/2013 at 1:02 PM
		</div>
		<div class="comment_text"><p>Hi Ray! Thanks for the great tutorial.</p><p>I did a big and obvious copy and paste just to try and get your bear bones code working. When I login and get redirected back, I get the following error:</p><p>key [STATE] doesn't exist in struct (keys:urltoken,sessionid)</p><p>Seems state isn't defined in the session. Do you know how to solve this?</p><p>I'm using Railo if that makes a difference?</p><p>Thanks again!<br>Mikey.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745487">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745487">34</a> by Raymond Camden
		posted on 7/5/2013 at 5:26 PM
		</div>
		<div class="comment_text"><p>Hmm. Well, it could be that you are losing your session when you leave the site and hit FB. Did you perhaps wait too long to click back?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745485">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745485">35</a> by AJ Mound
		posted on 7/10/2013 at 6:53 PM
		</div>
		<div class="comment_text"><p>Raymond,</p><p>I've been looking for this for a while.   Very useful!   Was able to get this working very quickly.</p><p>I'd like to ask an aggressively stupid question (as I've never dealt with a CFC in a session variable before):   How does one invoke this from a .cfm?   I see the dump, but I've been unable to use the invoke tag to parse out any of the information.</p><p>Thanks</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745490">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745490">36</a> by Raymond Camden
		posted on 7/10/2013 at 6:55 PM
		</div>
		<div class="comment_text"><p>If <a href="http://disq.us/url?url=http%3A%2F%2Fsession.foo%3A0GFwmortM5kwImb-zfNafWJu1YY&amp;cuid=3321886" rel="nofollow noopener" title="session.foo">session.foo</a> was a component, then it would simply be:</p><p>result = session.foo.someMethod()</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745494">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745494">37</a> by AJ Mound
		posted on 7/10/2013 at 7:12 PM
		</div>
		<div class="comment_text"><p>Wow, you responded in two minutes!  Thanks, Raymond!</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745493">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745493">38</a> by Michael
		posted on 7/29/2013 at 6:42 PM
		</div>
		<div class="comment_text"><p>Hi Ray,</p><p>I am still getting the error:</p><p>key [STATE] doesn't exist in struct (keys:urltoken,sessionid)</p><p>It seems that the session gets forgotten somehow. I might also add, that it IS initially set, because I am able to pass this to Facebook and then also have it returned in the URL.</p><p>However, when it comes to comparing the value of url.state to session.state ...it hits the error. Session is not defined.</p><p>Any idea how to solve this? I assume it happens because of a bug with cflocation?</p><p>I am using Railo.</p><p>Thanks,<br>Michael.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745495">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745495">39</a> by Raymond Camden
		posted on 7/30/2013 at 1:50 AM
		</div>
		<div class="comment_text"><p>Yes, it does sound as if the session isn't sticking. Can you look at the cookies in the request before you access the session variable? Maybe do a quick cflog before you go and when you come back and see if they are changing.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745501">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745501">40</a> by alessandro
		posted on 8/9/2013 at 7:03 AM
		</div>
		<div class="comment_text"><p>Hi. I've got this working on one of my sites, thanks!. When i try to run it on another subdomain of the site (same CF server, changed the FB appids etc) the session.state doesn't stick and bombs out on the redir.cfm page.. Any ideas? The sites area almost identical, sessionmanagement set as well. etc..</p><p>thanks</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745505">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745505">41</a> by Michael
		posted on 8/9/2013 at 11:41 AM
		</div>
		<div class="comment_text"><p>@alessandro there's definitely an issue with CF when saving session variables and then doing a redirect. The session will be created and you can even test for it, but when you redirect and come back, it's gone! Happens to me on Railo. Seems like it's a common bug and intermitent at that. In theory, you don't NEED this state part, but it's more secure that way.</p><p>I have founding saving session.state like so works better than saving it as part of a deeper nested session.</p><p>For me, session.state works, but if I did, session.facebookStuff.state it does not.</p><p>It's a weird one.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745499">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745499">42</a> by Adriano Azevedo
		posted on 8/19/2013 at 7:09 PM
		</div>
		<div class="comment_text"><p>If facebook user made logout? How clean session or to verify if facebook user session is valid?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745498">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745498">43</a> by Raymond Camden
		posted on 8/20/2013 at 1:37 AM
		</div>
		<div class="comment_text"><p>The call to login won't work if the session is expired. Nor would the call for user details.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745497">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745497">44</a> by AJ Mound
		posted on 8/21/2013 at 6:15 PM
		</div>
		<div class="comment_text"><p>So, here's a fascinating error from CF/Facebook interaction.   I created the world's simplest template that just outputs the URL variables sent to the page.   This is the code:</p><p>&lt;cfoutput&gt;#testVar1#&lt;/cfoutput&gt;&lt;br&gt;<br>&lt;cfoutput&gt;#testVar2#&lt;/cfoutput&gt;&lt;br&gt;</p><p>When I run it through my server, it behaves normally:<br>http://myserver/facebook/wtf.cfm?testvar1=abc&amp;testVar2=123<br>Returns: abc 123</p><p>This is the same server that I use for my FB application.   So, when it's accessed in the correct way via facebook, It appends a slash ("/") to one of the variables like this:</p><p><a href="https://disq.us/url?url=https%3A%2F%2Fapps.facebook.com%2Fapp_name%2Fwtf.cfm%3Ftestvar1%3Dabc%26testVar2%3D123%3AL2hJU86657TULiOdffbUx2DW31k&amp;cuid=3321886" rel="nofollow noopener" title="https://apps.facebook.com/app_name/wtf.cfm?testvar1=abc&amp;testVar2=123">https://apps.facebook.com/a...</a><br>Returns: abc 123/</p><p>Just curious if you think this is a result of FB messing with their server, or am I going crazy?</p><p>Thanks,<br>Andy</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745500">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745500">45</a> by Raymond Camden
		posted on 8/21/2013 at 6:19 PM
		</div>
		<div class="comment_text"><p>Not sure. Maybe they assume you aren't using URL params.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745504">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745504">46</a> by s. pradhan
		posted on 4/21/2014 at 6:13 PM
		</div>
		<div class="comment_text"><p>Hello. This process was working fine till some user notified me that they are getting errors. <br>Do you have any idea why this is happening all of a sudden?</p><p>struct<br>Charset 	[empty string]<br>ErrorDetail 	I/O Exception: peer not authenticated<br>Filecontent 	Connection Failure<br>Header 	[empty string]<br>Mimetype 	Unable to determine MIME type of file.<br>Responseheader 	<br>struct [empty]<br>Statuscode 	Connection Failure. Status code unavailable.<br>Text 	YES</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745502">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745502">47</a> by Snake
		posted on 6/8/2014 at 10:57 PM
		</div>
		<div class="comment_text"><p>isDefined(), in 2013, tut tut, Mr Cameron would have a field day with  that :-)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745507">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745507">48</a> by Raymond Camden
		posted on 6/8/2014 at 11:28 PM
		</div>
		<div class="comment_text"><p>Mr Cameron can suck it. ;) I don't get into the whole structKeyExists/isDefined thing. I just use what comes to mind first.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745510">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745510">49</a> by Marcel van Langen
		posted on 7/1/2014 at 3:57 PM
		</div>
		<div class="comment_text"><p>Great code, thanks. All of your code is working!  Right now I'm trying to post a new post on my Facebook wall. I've put together the following code, but it is not giving the desired result. It's not posting and there is no error.</p><p>Any thoughts would be great!</p><p><a href="http://disq.us/url?url=http%3A%2F%2Fpastebin.com%2F3PCYHrRK%3AdVb7KvwJq7_F0hsHg41C0a8Yqkc&amp;cuid=3321886" rel="nofollow noopener" title="http://pastebin.com/3PCYHrRK">http://pastebin.com/3PCYHrRK</a></p><p>BTW in my Pastebin are 2 possible solutions. Neither of them is working...</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745509">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745509">50</a> by Marcel van Langen
		posted on 7/1/2014 at 4:34 PM
		</div>
		<div class="comment_text"><p>It's getting better. I now realise  I have to ask permission to publish by extending the scope to publish_actions and publish_stream. I've also changed the cfhttparam from URL to FormField. Still no luck though...</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713745511">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713745511">51</a> by Raymond Camden
		posted on 7/1/2014 at 7:15 PM
		</div>
		<div class="comment_text"><p>When you changed it to ask for the right permission did you get a better error message?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1745435546">
	<div>
		<img src="https://disqus.com/api/users/avatars/disqus_w779ZNSJDf.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1745435546">52</a> by Grant Powell
		posted on 12/16/2014 at 6:50 PM
		</div>
		<div class="comment_text"><p>Where is the code for the Facebook API? "createObject("component","facebook")"</p></div>
	</div>
</div>
		
<div class="comment" id="c_1745440263">
	<div>
		<img src="https://disqus.com/api/users/avatars/cfjedimaster.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1745440263">53</a> (In reply to <a href="#c_1745435546">#52</a>) by Raymond Camden
		posted on 12/16/2014 at 6:53 PM
		</div>
		<div class="comment_text"><p>In the code blocks above.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1745449431">
	<div>
		<img src="https://disqus.com/api/users/avatars/disqus_w779ZNSJDf.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1745449431">54</a> by Grant Powell
		posted on 12/16/2014 at 6:58 PM
		</div>
		<div class="comment_text"><p>Nevermind, I see it.</p></div>
	</div>
</div>
		
<div class="comment" id="c_2002112822">
	<div>
		<img src="https://disqus.com/api/users/avatars/naveenkrishnamurthy.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_2002112822">55</a> by Naveen Krishnamurthy
		posted on 5/4/2015 at 10:55 AM
		</div>
		<div class="comment_text"><p>Thank you for the post.</p><p>I have implemented facebook authentication for my application.I get the following error when I try to deploy the code in Production for Facebook authentication.</p><p>In Local testing environment, it works as a charm..</p><p>Note: I have made the encessary changes to the facebook app to point to the website</p><p>Error:</p><p>-------</p><p>The proxy server received an invalid response from an upstream server.</p><p>The proxy server could not handle the request GET /index.cfm.</p><p>Reason: Error reading from remote server</p><p>Can you please let me know anything you know about this?</p></div>
	</div>
</div>
		
<div class="comment" id="c_2002288065">
	<div>
		<img src="https://disqus.com/api/users/avatars/cfjedimaster.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_2002288065">56</a> (In reply to <a href="#c_2002112822">#55</a>) by Raymond Camden
		posted on 5/4/2015 at 1:31 PM
		</div>
		<div class="comment_text"><p>It sounds like a network issue between production and Facebook. I'd check firewalls/etc on the production server.</p></div>
	</div>
</div>
		
<div class="comment" id="c_2660882429">
	<div>
		<img src="https://disqus.com/api/users/avatars/aescribens.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_2660882429">57</a> by Anthony Escribens
		posted on 5/5/2016 at 11:37 PM
		</div>
		<div class="comment_text"><p>Hi Ray, it looks like the scope is not retrieving the user's email, even when I enter "email" in the scope.  I'm testing it with my own account which I know I'm allowing my email to be used.</p><p>I got the 'name' and 'id' of the user which allows me to fetch the picture, but I really need the email.  Any suggestions?</p></div>
	</div>
</div>
		
<div class="comment" id="c_2660992043">
	<div>
		<img src="https://disqus.com/api/users/avatars/cfjedimaster.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_2660992043">58</a> (In reply to <a href="#c_2660882429">#57</a>) by Raymond Camden
		posted on 5/6/2016 at 1:07 AM
		</div>
		<div class="comment_text"><p>You got me there - I haven't done FB+CF since this post I think. Maybe check the app settings to see if it is blocked there so that even if you request the scope you can't get it.</p></div>
	</div>
</div>
		
<div class="comment" id="c_2661019789">
	<div>
		<img src="https://disqus.com/api/users/avatars/aescribens.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_2661019789">59</a> (In reply to <a href="#c_2660992043">#58</a>) by Anthony Escribens
		posted on 5/6/2016 at 1:30 AM
		</div>
		<div class="comment_text"><p>I checked the App Settings, email is allowed.  There must be someone else keeping the email from being retrieved.  I'll keep searching, thanks.</p></div>
	</div>
</div>
		
<div class="comment" id="c_2661023550">
	<div>
		<img src="https://disqus.com/api/users/avatars/cfjedimaster.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_2661023550">60</a> (In reply to <a href="#c_2661019789">#59</a>) by Raymond Camden
		posted on 5/6/2016 at 1:33 AM
		</div>
		<div class="comment_text"><p>Please post back if you find it.</p></div>
	</div>
</div>
		
<div class="comment" id="c_3360422759">
	<div>
		<img src="https://disqus.com/api/users/avatars/disqus_XKAchsScNn.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_3360422759">61</a> (In reply to <a href="#c_2661023550">#60</a>) by Matt Zimmerman
		posted on 6/14/2017 at 3:44 PM
		</div>
		<div class="comment_text"><p>Did you guys ever discover a solution to this? I am getting the same issue.</p><p>Guess I should google a little better you can use this URL instead:</p><p></p><pre><code>https://graph.facebook.com/v2.5/me?fields=id,name,email&amp;access_token=#variables.accesstoken#</code></pre></div>
	</div>
</div>
		
<div class="comment" id="c_4141099239">
	<div>
		<img src="https://disqus.com/api/users/avatars/dawesi.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_4141099239">62</a> (In reply to <a href="#c_3360422759">#61</a>) by dawesi
		posted on 10/12/2018 at 5:28 AM
		</div>
		<div class="comment_text"><p>you have to ask for it now as part of requested permissions, it's no longer automatic.</p></div>
	</div>
</div>
		