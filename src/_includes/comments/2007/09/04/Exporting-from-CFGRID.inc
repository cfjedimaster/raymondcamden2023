
<div class="comment" id="c_1713671364">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671364">1</a> by doug cain
		posted on 9/5/2007 at 10:54 AM
		</div>
		<div class="comment_text"><p>Cool, looks like you should be able to use this technique to get other information from the grid like total row count which would be handy for display to the user.</p><p>Just had a look and it's there:</p><p>params.totalLength</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671363">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671363">2</a> by doug cain
		posted on 9/5/2007 at 11:07 AM
		</div>
		<div class="comment_text"><p>I really meant</p><p>mydata.totalLength</p><p>:)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671361">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671361">3</a> by Michael White
		posted on 9/5/2007 at 6:07 PM
		</div>
		<div class="comment_text"><p>This is great stuff, Ray. I got you something small off your wishlist, not for anything in particular, just as a token of support for all you've done to help everyone with CF8</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671360">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671360">4</a> by Raymond Camden
		posted on 9/6/2007 at 3:47 AM
		</div>
		<div class="comment_text"><p>Thanks. After the day I had (will blog later) it is appreciated.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671368">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671368">5</a> by Azadi Saryev
		posted on 10/1/2007 at 2:32 PM
		</div>
		<div class="comment_text"><p>is it possible to access these properties, and the totalLength mentioned by doug, using a ajaxonload() function or other similar way? i.e. without having to click a button?<br>i have tried to use &lt;cfset ajaxonload('myfunction')&gt;, but it always returns 'undefined' for totalLength... it seems to fire before the grid is fully loaded, since my test alert pop up over an empty grid shell...</p><p>also, any ideas on how to re-render a grid on the client's side only, but with different default options for, say, pageSize? that would allow to add a custom 'Show X records per page' control, without hitting the db with every change in X...</p><p>Thanks!</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671370">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671370">6</a> by Neil Poso
		posted on 10/6/2007 at 4:32 AM
		</div>
		<div class="comment_text"><p>how do i get the values of 'name' and 'price' in a selected row using a javascript?</p><p>like for instance on your doDownload(), instead of generating an exported pdf data, i just would like to get the selected value of 'name' and 'price' and of course the 'id' of the row.</p><p>thanks a lot!</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671369">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671369">7</a> by Raymond Camden
		posted on 10/7/2007 at 11:43 PM
		</div>
		<div class="comment_text"><p>See: <a href="http://disq.us/url?url=http%3A%2F%2Fwww.coldfusionjedi.com%2Findex.cfm%2F2007%2F8%2F9%2FReacting-to-grid-row-selection%3AMnlWPi-Y7vodfGzBKEvvLTs0Xhg&amp;cuid=3321886" rel="nofollow noopener" title="http://www.coldfusionjedi.com/index.cfm/2007/8/9/Reacting-to-grid-row-selection">http://www.coldfusionjedi.c...</a></p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671366">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671366">8</a> by Neil Poso
		posted on 10/8/2007 at 8:28 PM
		</div>
		<div class="comment_text"><p>Thank you so much!</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671367">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671367">9</a> by Jim
		posted on 3/9/2009 at 7:13 PM
		</div>
		<div class="comment_text"><p>Ray,</p><p>Do you know if there is a similar call in jquery like the CF call [ColdFusion.Grid.getGridObject]?  We are using a jquery plugin (jqgrid) and need to dump the query to pdf or excel.</p><p>thanks, Jim</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671371">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671371">10</a> by Raymond Camden
		posted on 3/9/2009 at 7:15 PM
		</div>
		<div class="comment_text"><p>You would need to check with the plugin, not jQuery. The plugin should have it's own API.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671372">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671372">11</a> by josh
		posted on 4/8/2009 at 10:35 PM
		</div>
		<div class="comment_text"><p>Hi Ray, is there a way to use this method and print all records in the grid but with the sort parameters specified by the user?  It seems like there should be but I can't figure it out.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671373">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671373">12</a> by Raymond Camden
		posted on 4/8/2009 at 10:37 PM
		</div>
		<div class="comment_text"><p>Can you be more specific? Are you saying it isn't exporting per the current sort?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671374">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671374">13</a> by josh
		posted on 4/9/2009 at 8:13 PM
		</div>
		<div class="comment_text"><p>it's exporting, but only the current page.  I want all the pages returned and displayed in a single document, not just the current page.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671377">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671377">14</a> by Raymond Camden
		posted on 4/9/2009 at 8:14 PM
		</div>
		<div class="comment_text"><p>Then you have to modify my code. My code gets the page and sort and runs a CFM. Your code would not worry about the page. Should be easy enough.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671376">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671376">15</a> by josh
		posted on 4/9/2009 at 9:16 PM
		</div>
		<div class="comment_text"><p>I guess what I'm trying to get at, and I'm sorry I'm kind of new at this, is that since the page and pagesize are required arguments, how do I specify them so that they show all.  I can get it to display more records just by bumping up the default numbers for page and pagesize but I can't get it to just show all of them.  thanks again.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671375">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671375">16</a> by Raymond Camden
		posted on 4/10/2009 at 5:54 PM
		</div>
		<div class="comment_text"><p>I may not be getting you still. My code gets the current page and dir from the grid, and sends it to a new CFM. THe last script block on the blog post. All you have to do is NOT use the page and size values. If your method, getData(), requires it, simply modify it to make them optional, or, worse comes to worse, if getData() is used to power the grid, make a new method, getAll() (but that's really poor design though).</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671379">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671379">17</a> by Sanjeev
		posted on 4/23/2009 at 12:41 AM
		</div>
		<div class="comment_text"><p>The mydata.totalLength gives the length of the grid records size/page.</p><p>How do i know if the grid is populated or not..in the sense, if the Query returned records or not?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671378">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671378">18</a> by Raymond Camden
		posted on 4/23/2009 at 12:42 AM
		</div>
		<div class="comment_text"><p>Search my blog for cfgrid - I know I covered this in the past 4 weeks (but a bit too busy to searhc myself).</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671380">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671380">19</a> by futr_vision
		posted on 6/22/2009 at 7:28 PM
		</div>
		<div class="comment_text"><p>Is there a way to export cfgrid to Excel either by hard coding or using a plugin or is there a better way to get the data into Excel such as taking the data directly from the DB via the query?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671381">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671381">20</a> by Raymond Camden
		posted on 6/22/2009 at 11:28 PM
		</div>
		<div class="comment_text"><p>You would just modify my code to output an HTML table. That's the cheesy/simple way to do it. You have to modify the cfcontent/cfheader tag, but that's really it.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671382">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671382">21</a> by futr_vision
		posted on 6/24/2009 at 11:47 PM
		</div>
		<div class="comment_text"><p>Here's a pretty slick solution to export all records to Excel</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671383">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671383">22</a> by Ed
		posted on 9/10/2009 at 9:02 PM
		</div>
		<div class="comment_text"><p>This export from grid example is great. I can export the current page of records to excel just fine.  However, I am struggling with the option in doDownload() that exports the current grid page. I have multiple pages in the grid and need to export all records to the excel document.  Can you help me understand the page variable you use?  Thanks for all your great examples!</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671384">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671384">23</a> by Raymond Camden
		posted on 9/10/2009 at 9:04 PM
		</div>
		<div class="comment_text"><p>Add a new button that calls a new function. Have it run a CFM, just like the other function, but this one doesn't bother getting the page number. It could - if it wants, get the sort and dir. Then your CFM code pretty much just mimics the other code - but with no pagination. (To be honest, I'd use one CFM that made the paging optional.)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671385">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671385">24</a> by Ed
		posted on 9/11/2009 at 9:28 PM
		</div>
		<div class="comment_text"><p>Hi Ray, well I have solved the export total grid data problem. I just added a line to the doDownload() function to get the total of the getDataSource.  This gets the total limit to send to the download excel file. The problem I have now is, I am using a filtercolumn and filter text field to generate the dynamic grid.  When I filter for data and then download to excel, i get the correct number of rows , but not the correct data.  I am not passing the filtercolumn or filter string to the CFC. So I am getting the original defalut data from onload.  Any idea how to pass the filtercolumn in the doDownload() function to my CFC?<br>Updated code:<br>function doDownloadAll() {<br>    var mygrid = ColdFusion.Grid.getGridObject('reportsGrid');<br>    var mydata = mygrid.getDataSource();<br>    var params = mydata.lastOptions.params;<br>    var sort = params.sort;<br>    var dir = params.dir;<br>    var page = params.start+1;<br>    var size = mygrid.getDataSource().totalLength;<br>    document.location.href='download2.cfm?page='+page+'&amp;sort='+sort+'&amp;dir='+dir+'&amp;size='+size;<br>}</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671387">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671387">25</a> by Raymond Camden
		posted on 9/12/2009 at 12:17 AM
		</div>
		<div class="comment_text"><p>You would need to get it and add it to the URL in the document.location.href. As for how you get the filter, it depends on how you implemented it. Is it just a form field? Then you use normal JS type DOM ops to get the form value.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671388">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671388">26</a> by Ed
		posted on 9/12/2009 at 12:52 AM
		</div>
		<div class="comment_text"><p>YESSSSS!!!  It works perfectly now.  Now I will be able to enjoy my weekend.  Thank you.<br>Update:<br>document.location.href='download2.cfm?page='+page+'&amp;sort='+sort+'&amp;dir='+dir+'&amp;size='+size+'&amp;filtercolumn='+filtercolumn+'&amp;filter='+filter;</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671389">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671389">27</a> by josh
		posted on 9/26/2009 at 12:07 AM
		</div>
		<div class="comment_text"><p>hi ray, i've gotten this working fairly well but my report is not sorting properly.  The sortcol and sortdir are getting passed properly, as I can view them in the url but the sort is not being applied.  I've got other filterparams that do pass and apply properly, just not the sort and dir.  Does the sort work in your example?  I can't see a meaningful difference in what i've done vs what is presented.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671395">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671395">28</a> by Raymond Camden
		posted on 9/26/2009 at 12:09 AM
		</div>
		<div class="comment_text"><p>If you know the sort and sortdir URL variables are passed, then check your CF code to ensure it is actually _using_ it properly. You can add some simple &lt;cflog&gt; lines to test, or a cfdump too.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671392">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671392">29</a> by Alan
		posted on 2/16/2010 at 9:52 PM
		</div>
		<div class="comment_text"><p>Hello,</p><p>For some reason the following line of code sets the variable params to "undefined",</p><p>var params = mydata.lastOptions.params;</p><p>The code you suggested prior to that line works just fine. I have a cfgrid and I just want to know if the user sorted the list by some column before exporting to Excel (I want to preserve that sorted cfgrid list in Excel)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671394">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671394">30</a> by Alan
		posted on 2/17/2010 at 3:01 AM
		</div>
		<div class="comment_text"><p>Actually it turns out that you must use a bind for the cfgrid for it to work. Is there anyway I can use the "query" attribute instead and still be able to get the sort column?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671403">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671403">31</a> by Willene
		posted on 2/26/2010 at 3:21 AM
		</div>
		<div class="comment_text"><p>When trying to use this code the error on page message comes up which gives the message<br>"lastOptions.params; " is null or not an object</p><p>The code for  mygrid = ColdFusion.Grid.getGridObject('InOutStatus'); is used in another function - would that be a cause.  When searching on google, this page is the main result.  Thanks for your help.<br>	var mydatad = mygridd.getDataSource().totalLength;</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671393">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671393">32</a> by Raymond Camden
		posted on 2/26/2010 at 3:22 AM
		</div>
		<div class="comment_text"><p>If you are using this in CF9, it probably won't work. The code used for Grids had a major update (2 Ext versions).</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671397">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671397">33</a> by Willene
		posted on 2/26/2010 at 3:37 AM
		</div>
		<div class="comment_text"><p>That was super fast.  We are using Cold Fusion 8 or 8.01.  We are in the process of moving to ColdFusion 9.</p><p>Thanks</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671396">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671396">34</a> by Raymond Camden
		posted on 2/26/2010 at 3:42 AM
		</div>
		<div class="comment_text"><p>Hmm. So I can't see why getting the grid _elsewhere_ would be a bug, but if you have code on the page that isn't my code, I'd try removing it (just for now) and seeing if that is the issue. Not that the bug would be your fault, or mine, but that maybe there is a conflict between the two.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671399">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671399">35</a> by Nik
		posted on 5/20/2010 at 8:35 AM
		</div>
		<div class="comment_text"><p>Do you know how to do this in CF9? I am looking for something similar but wondering if its possible to do this using CF9 and cfspreadsheet.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671398">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671398">36</a> by Raymond Camden
		posted on 5/22/2010 at 12:16 AM
		</div>
		<div class="comment_text"><p>It is possible - the only difference is  in how you get the data. I think it is getStore not getDataSource() anymore.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671400">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671400">37</a> by Morph
		posted on 8/19/2010 at 3:29 PM
		</div>
		<div class="comment_text"><p>Hi Ray,<br>i have a problem with my cfgrid. I want to get the result of a query over a ajax request. It means, that I push a button and the query runs in the background. Its working but not with cfgrid... I just make this code of the request Site:</p><p>&lt;cfoutput&gt;<br>&lt;cfquery datasource="#data_source#" name="test"&gt;<br>#PreserveSingleQuotes(test)#<br>&lt;/cfquery&gt;<br>&lt;/cfoutput&gt;</p><p>&lt;cfform&gt;<br>    &lt;cfgrid name = "FirstGrid" format="Flash"<br>        height="320" width="1200"<br>        font="Tahoma" fontsize="12"<br>        query = "test"&gt;<br>    &lt;/cfgrid&gt;<br>&lt;/cfform&gt;</p><p>Can you get me an answer?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671404">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671404">38</a> by Michael White
		posted on 8/19/2010 at 3:34 PM
		</div>
		<div class="comment_text"><p>I think you're going to have problems mixing ajax and flash</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671402">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671402">39</a> by Raymond Camden
		posted on 8/19/2010 at 3:51 PM
		</div>
		<div class="comment_text"><p>Sorry - but I don't recommend using Flash Forms at all. Use Flex - sure. But not Flash Forms.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671405">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671405">40</a> by Morph
		posted on 8/19/2010 at 4:59 PM
		</div>
		<div class="comment_text"><p>Thanks for your answer, but its doesn´t matter... its also doesn´t working with html</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671407">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671407">41</a> by Raymond Camden
		posted on 8/19/2010 at 5:03 PM
		</div>
		<div class="comment_text"><p>Can you post your latest code to Pastebin and post the URL here?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671406">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671406">42</a> by Morph
		posted on 8/19/2010 at 5:29 PM
		</div>
		<div class="comment_text"><p>On the main.cfm there is a submit button which send all entries in the input fields to the <br>second.cfm. This is the button: (hdnr is one of the entries)</p><p>var sUrl = ("#application.pfad_root#internal/second.cfm?hdnr="+document.test.number.value + "&amp;.......);<br>&lt;button name="btnSearch" type="submit" value="startsql" onClick="startajax('divposition','',sUrl,'#ajaxpicture#');return false;"&gt;startSQL&lt;/button&gt;<br>----------------------------------------------------------<br>second.cfm:</p><p>&lt;cfset test = "Select......where hdnr='#hdnr#'"&gt;</p><p>&lt;cfoutput&gt;<br>&lt;cfquery datasource="#data_source#" name="test"&gt;<br>#PreserveSingleQuotes(test)#<br>&lt;/cfquery&gt;<br>&lt;/cfoutput&gt;</p><p>&lt;cfform&gt;<br>&lt;cfgrid name = "FirstGrid" format="html"<br>height="320" width="1200"<br>font="Tahoma" fontsize="12"<br>query = "test"&gt;<br>&lt;/cfgrid&gt;<br>&lt;/cfform&gt;<br>-----------------------------------------------------------<br>These is the function ajax</p><p>&lt;cfoutput&gt;<br>&lt;script&gt;<br>function getXmlObject() {<br>	var http_request;<br>	if (window.XMLHttpRequest) {<br>		http_request = new XMLHttpRequest();<br>	} else {<br>		if (window.ActiveXObject) {<br>			http_request = new ActiveXObject("Microsoft.XMLHTTP");<br>		}<br>	}<br>	return http_request;<br>}</p><p>function startajax(sDiv, sText, sAufruf, sBild) {<br>	document.getElementById(sDiv).innerHTML = '&lt;span class="Stil6"&gt;&lt;img src="' + sBild + '" /&gt; ' + sText + '&lt;/span&gt;';<br>	var http_request_dat = getXmlObject();  <br>	http_request_dat.onreadystatechange = function() {<br>		try {<br>			if (http_request_dat.readyState == 4) {<br>				if (http_request_dat.status == 200) {<br>					document.getElementById(sDiv).innerHTML = http_request_dat.responseText;<br>				}<br>			}<br>			return true;<br>		} catch(e) { <br>			//nichts <br>		}<br>	};<br>	<a href="http://disq.us/url?url=http%3A%2F%2Fhttp_request_dat.open%3AYKnVzChzAorLzWhJlHtGMidoJHg&amp;cuid=3321886" rel="nofollow noopener" title="http_request_dat.open">http_request_dat.open</a>("POST", "#application.http_pfad#" + sAufruf + "#pageVar.URLDefaultParam#");<br>	http_request_dat.setRequestHeader('Content-Type','application/x-www-form-urlencoded; charset=ISO-8859-1');<br>	http_request_dat.send('parameter=value&amp;parameter2=wert2');<br>}<br>&lt;/script&gt;<br>&lt;/cfoutput&gt;</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671409">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671409">43</a> by Raymond Camden
		posted on 8/20/2010 at 5:20 AM
		</div>
		<div class="comment_text"><p>I got to say I'm totally confused. Your first page should be the grid but it should also include the JS to fire off the request to the next page. I don't see that in your first page.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671410">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671410">44</a> by Morph
		posted on 8/20/2010 at 10:26 AM
		</div>
		<div class="comment_text"><p>Hi,<br>the ajax js is on the first page. The grid is on the second page because I want only show the grid if somebody click the button.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671412">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671412">45</a> by Raymond Camden
		posted on 8/20/2010 at 3:42 PM
		</div>
		<div class="comment_text"><p>So your intended process is - page 1 they click something and it laods page 2 which shows the grid? So this isn't an grid export issue like the blog topic is about? Is it online perhaps where we can see?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671411">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671411">46</a> by Morph
		posted on 8/20/2010 at 3:52 PM
		</div>
		<div class="comment_text"><p>Oh sorry for the wrong posting. Yes you are right, page1 --&gt; click --&gt; page2 with grid. Unfortunally, it is an Intranet. I cannot show you the page. Can you give me an adivce for my proble`m?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671413">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671413">47</a> by Raymond Camden
		posted on 8/20/2010 at 3:59 PM
		</div>
		<div class="comment_text"><p>If you are using page A to load content B that contains a grid, you may run into issues because A never loaded the scripts the B needs. You can try the cfajaximport tag.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671414">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671414">48</a> by Morph
		posted on 8/20/2010 at 4:58 PM
		</div>
		<div class="comment_text"><p>I don´t know how it works. I have to put the cfajaximport in page1. In page two, I have to write the cfgrid. Is that correct? What about the button?<br>thanking you in anticipation</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671416">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671416">49</a> by Morph
		posted on 8/20/2010 at 6:17 PM
		</div>
		<div class="comment_text"><p>Your example with &lt;cfajaximport tags="cfwindow"&gt; is running (without cfgrid). How can I use cfgrid in it?</p><p>Thanks again</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671417">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671417">50</a> by Raymond Camden
		posted on 8/20/2010 at 6:18 PM
		</div>
		<div class="comment_text"><p>Switch tags to cfgrid?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671418">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671418">51</a> by Morph
		posted on 8/23/2010 at 4:03 PM
		</div>
		<div class="comment_text"><p>Hi, this is my mainpage:<br>&lt;cfoutput&gt;<br>&lt;cfajaximport tags="cfgrid"&gt;</p><p>&lt;a href="JavaScript:ColdFusion.Window.create('ImageWindow','Butterfly Image','page2.cfm',{width:450, height:375})"&gt;<br> &lt;h3 style="color:RosyBrown"&gt;<br>        &lt;b&gt;click&lt;/b&gt;<br>    &lt;/h3&gt;<br>&lt;/a&gt;<br>&lt;/cfoutput&gt;</p><p>I know, that is not correct:<br>&lt;a href="JavaScript:ColdFusion.Window.create....<br>But what is correct?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671419">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671419">52</a> by Raymond Camden
		posted on 8/24/2010 at 4:04 PM
		</div>
		<div class="comment_text"><p>I think you are just missing initshow in the config object. Please see the CFML Reference as it details ColdFusion.Window.create fully.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671421">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671421">53</a> by Ron Rattie
		posted on 10/19/2011 at 9:36 PM
		</div>
		<div class="comment_text"><p>How would you combine this with searching the cfgrid (as you demonstrated here <a href="http://disq.us/url?url=http%3A%2F%2Fwww.coldfusionjedi.com%2Findex.cfm%2F2010%2F4%2F29%2FCan-you-search-a-CFGRID%3AELygsv3ksYUWeI3W7ig2zaEJ_PY&amp;cuid=3321886" rel="nofollow noopener" title="http://www.coldfusionjedi.com/index.cfm/2010/4/29/Can-you-search-a-CFGRID">http://www.coldfusionjedi.c...</a> )?  I'm trying, but I can't seem to pass the column and filter.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671420">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671420">54</a> by Raymond Camden
		posted on 10/19/2011 at 9:39 PM
		</div>
		<div class="comment_text"><p>Do you mean - how would you add 'export' to the grid that has the search capability too?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671422">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671422">55</a> by Ron Rattie
		posted on 10/19/2011 at 9:43 PM
		</div>
		<div class="comment_text"><p>yes, exactly.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671423">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671423">56</a> by Raymond Camden
		posted on 10/19/2011 at 9:49 PM
		</div>
		<div class="comment_text"><p>Um, sure. It can be done. I guess I'll add this to my queue of blog entries. Wishlisting makes the queue go faster just fyi. ;)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671425">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671425">57</a> by Ron Rattie
		posted on 10/19/2011 at 10:38 PM
		</div>
		<div class="comment_text"><p>I figured it out!  If you have a cfselect menu named 'column1' and cfinput named 'filter1' (this is the table column and then what you are using to filter).</p><p>The JS would look like this:</p><p>	var column = ColdFusion.getElementValue ('column1');<br>	var filter = ColdFusion.getElementValue ('filter1');<br>	var searchd = ColdFusion.getElementValue ('search1');<br>	document.location.href='export.cfm?page='+page+'&amp;sort='+gdsort+'&amp;dir='+dir+'&amp;size='+params.limit+'&amp;column='+column+'&amp;filter='+filter+'&amp;search='+searchd;</p><p>Thanks Ray!  Not because you gave me the answer, but because reading all your blogs has helped me learn so much about CF that I was able to figure this out on my own.</p><p>- Ron</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713671426">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713671426">58</a> by Raymond Camden
		posted on 10/20/2011 at 1:54 AM
		</div>
		<div class="comment_text"><p>Woot - glad you got it. :)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1971397305">
	<div>
		<img src="https://disqus.com/api/users/avatars/disqus_LjSy6iBKvE.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1971397305">59</a> (In reply to <a href="#c_1713671417">#50</a>) by Cita
		posted on 4/16/2015 at 8:33 PM
		</div>
		<div class="comment_text"><p>Hi Ray,</p><p>I'm using CF10 CFGRID.  I can export my CFGRID output to PDF or Excel.  However, a user is requesting that when he hides some columns on the grid, he wants only the columns shown when he exports to PDF.  Is this possible?  Also, where can I find the documentation for the ColdFusion.Grid.getGridObject.  In CF doc, it's directing me to Ext JS library.  <br>Thanks for any help.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1972485366">
	<div>
		<img src="https://disqus.com/api/users/avatars/cfjedimaster.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1972485366">60</a> (In reply to <a href="#c_1971397305">#59</a>) by Raymond Camden
		posted on 4/17/2015 at 1:18 PM
		</div>
		<div class="comment_text"><p>Yes, it is possible. You would need to look at the Ext docs and find the API that returns the visible columns, and then pass this to the server side.</p><p>Docs for CF may be found here: <a href="https://disq.us/url?url=https%3A%2F%2Fwikidocs.adobe.com%2Fwiki%2Fdisplay%2Fcoldfusionen%2FColdFusion.Grid.getGridObject%3AzaXOlS-tb3BYRVkcVwMxZ4xEikc&amp;cuid=3321886" rel="nofollow noopener" title="https://wikidocs.adobe.com/wiki/display/coldfusionen/ColdFusion.Grid.getGridObject">https://wikidocs.adobe.com/...</a></p><p>And yes - CF will direct you to the Ext docs - because CFGRID wraps an Ext object.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1976282605">
	<div>
		<img src="https://disqus.com/api/users/avatars/disqus_Xbml5DhGwV.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1976282605">61</a> (In reply to <a href="#c_1972485366">#60</a>) by Cita
		posted on 4/19/2015 at 8:24 PM
		</div>
		<div class="comment_text"><p>Hi Ray,</p><p>My problem is finding the API documentation.  I'm not familiar with the Ext but looked at the Ext library referred in CF doc.  I also checked this folder Y:\ColdFusion10\cfusion\wwwroot\CFIDE\scripts\ajax\ext\docs\output. but not sure.  Can you please direct me where to find it?<br>Many Thanks.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1976535772">
	<div>
		<img src="https://disqus.com/api/users/avatars/cfjedimaster.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1976535772">62</a> (In reply to <a href="#c_1976282605">#61</a>) by Raymond Camden
		posted on 4/19/2015 at 11:47 PM
		</div>
		<div class="comment_text"><p>Well, what I would do is look at the headers of the script files. They should have a version #. Then Google for that. I don't use CF10 (I have CF11 here) but in the past, that's what I did to a) find out what version of Ext CF shipped and then find the relevant docs.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1977617414">
	<div>
		<img src="https://disqus.com/api/users/avatars/disqus_Xbml5DhGwV.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1977617414">63</a> (In reply to <a href="#c_1976535772">#62</a>) by Cita
		posted on 4/20/2015 at 4:03 PM
		</div>
		<div class="comment_text"><p>Thanks, Ray.  CF10 is using EXT 3.1 and was able to find the API documentation; however, I was unable to find in the doc related to grid columns/header (maybe did not dig enough).  Anyway, I moved my apps to CF11 since we have an existing env.  There's a method called getVisibleGridColumns() and used it in my function call.</p><p>function doDownload()</p><p>var mygrid = ColdFusion.Grid.getGridObject('reportsGrid');</p><p>//added <br>var myheader = mygrid.header.Container.getVisibleGridColumns();<br>//tried<br> var mycols = mygrid.getVisibleGridColumns();<br>These 2 statements did not work.  I know I'm missing something but not sure...<br>Any help is greatly appreciated.  Thanks in advance.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1977627608">
	<div>
		<img src="https://disqus.com/api/users/avatars/cfjedimaster.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1977627608">64</a> (In reply to <a href="#c_1977617414">#63</a>) by Raymond Camden
		posted on 4/20/2015 at 4:08 PM
		</div>
		<div class="comment_text"><p>Unfortunately I can't really help. I urge developers to not use cfgrid and other cf ui tags anymore and instead simply avoid the entire feature altogether. To be clear, I'm not saying avoid Ext, I'm saying avoid the CF UI layer. See this for more info: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fcfjedimaster%2FColdFusion-UI-the-Right-Way%3AdWp8Vodv58fFcKoZr8J6uKyEpno&amp;cuid=3321886" rel="nofollow noopener" title="https://github.com/cfjedimaster/ColdFusion-UI-the-Right-Way">https://github.com/cfjedima...</a></p></div>
	</div>
</div>
		
<div class="comment" id="c_2140428013">
	<div>
		<img src="https://disqus.com/api/users/avatars/raslee74.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_2140428013">65</a> by Stephanie Lee
		posted on 7/16/2015 at 7:57 PM
		</div>
		<div class="comment_text"><p>Since this code was originally used for development in ColdFusion 9 and we are now upgrading to ColdFusion 11, I wanted to post my altered solution to the JavaScript portion. I had to rewrite:</p><p>var reclamaGrid = ColdFusion.Grid.getGridObject('cfGridName');<br>var reclamaData = reclamaGrid.getStore();<br>var params = reclamaData.lastOptions.params;<br>var sort = params.sort;<br>var dir = params.dir;<br>var size = params.limit;</p><p>to</p><p>var reclamaGrid = ColdFusion.Grid.getGridObject('cfGridName');<br>var reclamaData = reclamaGrid.getStore();<br>var lastOptions = reclamaData.lastOptions;</p><p>if (lastOptions.sorters.length == 0){</p><p>   var sort = "nomineeName";<br>   var dir = "ASC";<br>}<br>else{<br>   var sort = lastOptions.sorters[0].property;<br>   var dir = lastOptions.sorters[0].direction;<br>	}<br>var size = lastOptions.limit;</p><p>I could not find where the original sort column and direction were stored, however, so I hard coded those to what it would be if it were blank. I hope this will help someone out there struggling.</p></div>
	</div>
</div>
		