
<div class="comment" id="c_1713669118">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669118">1</a> by Ben Nadel
		posted on 7/26/2007 at 12:58 AM
		</div>
		<div class="comment_text"><p>A PDF utility component... that just all the makings of a massively popular CFC :)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669121">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669121">2</a> by Raymond Camden
		posted on 7/26/2007 at 1:01 AM
		</div>
		<div class="comment_text"><p>My next utility will be pageGet. Right now you can easily delete pages, but what if you want just one page? Well the answer is to obviously delete everything else, but I'll have a utility function to make it easier.</p><p>I've actually got an entire online PDF Editor I worked on for the CF8 tour. I'm going to load it up when I wrap the CFPDF series.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669123">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669123">3</a> by Ben Nadel
		posted on 7/26/2007 at 1:07 AM
		</div>
		<div class="comment_text"><p>That's gonna be sweet! I work with a lot of legal clients and they all but worship the PDF as a medium.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669124">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669124">4</a> by Lola LB
		posted on 7/26/2007 at 3:55 PM
		</div>
		<div class="comment_text"><p>Cool!  I can see a lot of use for those PDF utils.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669122">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669122">5</a> by O?uz Demirkap?
		posted on 9/10/2007 at 9:56 PM
		</div>
		<div class="comment_text"><p>Any update for pdfutils? :)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669125">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669125">6</a> by Raymond Camden
		posted on 9/10/2007 at 10:00 PM
		</div>
		<div class="comment_text"><p>I haven't done anything special with it - but it probably is time to release it at RIAForge. Oguz, if I don't by EOD, yell at me.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669119">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669119">7</a> by Mark
		posted on 4/5/2008 at 7:52 AM
		</div>
		<div class="comment_text"><p>The demo doesnt seem to just work.<br>test.cfm seems OK<br>test2.cfm dumps the PDFDocument structure? Is the cfpdf write failing silently?<br>genpdf.cfm works (just try paristoread_new.pdf or whatever)<br>xmptest.cfm returns [empty string] no matter what I try. . ...</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669126">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669126">8</a> by Raymond Camden
		posted on 4/5/2008 at 9:36 PM
		</div>
		<div class="comment_text"><p>If you look at test2, you will see it does indeed dump out the pdf structure. That is expected. And it should overwrite page2.pdf.</p><p>As for xmptest.cfm, it will be empty if your PDF doesn't use XMP. Not all pdfs do. If you think your does and it doesn't work, email me the PDF.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669134">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669134">9</a> by Johnny
		posted on 7/22/2008 at 7:07 PM
		</div>
		<div class="comment_text"><p>Nice component.<br>Can I do the same in MX7?<br>Thanks</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669131">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669131">10</a> by Raymond Camden
		posted on 7/24/2008 at 6:39 PM
		</div>
		<div class="comment_text"><p>Not that I know of.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669135">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669135">11</a> by Tim
		posted on 9/29/2008 at 10:37 PM
		</div>
		<div class="comment_text"><p>Great tool! But it looks like it replaces newline characters with spaces. Is there any way to figure out where they used to be?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669137">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669137">12</a> by Raymond Camden
		posted on 9/29/2008 at 10:43 PM
		</div>
		<div class="comment_text"><p>I just checked, and my code isn't doing anything to the text. It must be how it comes from DDX.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669146">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669146">13</a> by Raymond Camden
		posted on 9/29/2008 at 11:09 PM
		</div>
		<div class="comment_text"><p>Dumb question - but if you are outputting it into HTML, don't forget newlines won't be displayed unless you use PRE tags.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669145">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669145">14</a> by Armando
		posted on 2/13/2009 at 3:53 AM
		</div>
		<div class="comment_text"><p>When I use getText I just get back a blank page. I tried PDFUtils because all my other attempts to use DDX to get text from a pdf also failed - all return a blank page (unless there is an error).</p><p>Processing seems to stop as soon as the the cfpdf tag calls processddx.</p><p>This is on a shared coldfusion 8 server at crystaltech.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669153">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669153">15</a> by Raymond Camden
		posted on 2/14/2009 at 9:08 PM
		</div>
		<div class="comment_text"><p>Are you sure processing ends? Do you get an error? What happens when you try DDX my itself?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669154">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669154">16</a> by Virginia Neal
		posted on 5/29/2010 at 3:24 AM
		</div>
		<div class="comment_text"><p>As you probably know, in CF9 the cfpdf tag can now use action="extracttext" to pull text out of the pdf document.  According to the documentation you should also be able to use useStructure="true" along with honourspaces="true" in order to return the structure.  However, I have been unable to get this to work.  I simply need to get line breaks, centering, and indents/tabs, but no luck thus far.  Any ideas?<br>Thanks</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669152">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669152">17</a> by Raymond Camden
		posted on 5/30/2010 at 5:54 PM
		</div>
		<div class="comment_text"><p>How is it _not_ working? Do you get a syntax error? Something else?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669151">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669151">18</a> by Virginia Neal
		posted on 6/1/2010 at 6:18 PM
		</div>
		<div class="comment_text"><p>The cfpdf tag is extracting the content of the pdf file and it is readable; however, the basic structure of the document is lost.  There are no line breaks, no indenting, no centering.  <br>I have tried both .doc and .docx.  Code is simple<br>&lt;cfpdf useStructure="true" addquads="false" honourspaces="true" type="string" action="extracttext" source="test.docx.pdf"  name="pdfToText" /&gt;<br>The document is simple and contains about 7 lines, just enough to test line breaks, indents, and centering.<br>Thanks for any help you can provide.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669149">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669149">19</a> by Raymond Camden
		posted on 6/1/2010 at 6:21 PM
		</div>
		<div class="comment_text"><p>Just to be dumb - how are you testing that line breaks were removed? Remember that if you just output it to the browser, since it is an HTML environment, you won't see the line breaks unless you view source.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669150">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669150">20</a> by Virginia Neal
		posted on 6/1/2010 at 6:34 PM
		</div>
		<div class="comment_text"><p>I wrote the results to a text file and checked the content of the file.  BTW, I also tried the extract using type='xml' and that did not work any better.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669158">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669158">21</a> by Raymond Camden
		posted on 6/1/2010 at 6:35 PM
		</div>
		<div class="comment_text"><p>Interesting. Do you feel comfortable sharing your PDF with me?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669155">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669155">22</a> by Virginia Neal
		posted on 6/1/2010 at 6:38 PM
		</div>
		<div class="comment_text"><p>No problem, it is a simple file.  How do you want me to send it to you.  I don't see a place on your blog where I can upload the file.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669162">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669162">23</a> by Raymond Camden
		posted on 6/1/2010 at 6:40 PM
		</div>
		<div class="comment_text"><p>Email it to me. ray at camdenfamily dot com</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669160">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669160">24</a> by Raymond Camden
		posted on 6/1/2010 at 7:21 PM
		</div>
		<div class="comment_text"><p>Well I wish I had something nice to report, but I don't. I'm seeing the same as you. I also tried my pdfutils component (even though I assumed Adobe was using the exact same code (ddx) for theirs) and I got the same result. If you use the quads option you DO seem to get the proper data, but you would need to 'draw' it on screen to get it which would be overkill.</p><p>This may be a bit much - but you could use Google Docs. I have a wrapper CFC for it. You could upload to Google Docs than download as HTML or text. It would be slow(well slowish), but if you needed it for one time conversions, it would be acceptable I think.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669156">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669156">25</a> by Virginia Neal
		posted on 6/1/2010 at 7:30 PM
		</div>
		<div class="comment_text"><p>Thanks much for trying!!<br>I had also tried the DDX approach and the quads option.  I had briefly considered using the coordinates, but the docs I need to convert are gigantic and I get as many as 40 a day.  Given that, I don't think the Google approach will work either.  I have 3rd party software that currently converts Word to PDF and to Text, but I had hoped to get rid of the software and let CF do both.   With CF 9, I am now able to convert the docs to PDF, but thus far no easy way to go to text.  Maybe the POI will work.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669161">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669161">26</a> by Raymond Camden
		posted on 6/1/2010 at 7:32 PM
		</div>
		<div class="comment_text"><p>Well, 40 isn't so much. If you assume 1 minute of network time to do the 'work' (really, Google is), I'd call this fair. I'd just do it behind the scenes - ie not make the user wait for it.</p><p>As to your 3rd party tool - shoot, if it works, use it! I'd brush my teeth with ColdFusion if I could, but at the end of the day, you want to use what works best.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669163">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669163">27</a> by Virginia Neal
		posted on 6/1/2010 at 7:42 PM
		</div>
		<div class="comment_text"><p>That is 40 gigantic docs all in one batch with processing handled, as you said, "behind the scenes".   Going to a complete CF solution, without the 3rd party conversion software, would save us some bucks, and small government agencies are all about saving money.  :-)</p><p>Anyway, thanks again for your help!!  It is good to know it is not just me and banging my head for another week won't change the fact that the tag won't work!</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669165">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669165">28</a> by Corey Christensen
		posted on 4/29/2011 at 2:11 AM
		</div>
		<div class="comment_text"><p>Hey guys. its AOC's finest! How u doing? I'm trying to fix a prob with old skool verity collections that is requiring me to build a new search interface for about 500+ pdfs. we are only running cf8 (boo) so wondering if you have any pointers to allow for cf searching in pdfs!!</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669166">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669166">29</a> by Raymond Camden
		posted on 4/29/2011 at 2:12 AM
		</div>
		<div class="comment_text"><p>Verity can index PDFs. :)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669167">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669167">30</a> by Virginia Neal
		posted on 4/29/2011 at 2:58 AM
		</div>
		<div class="comment_text"><p>Hi Corey.  As you may remember we do not use Verity, so I can't help.  Wondered what happened to you - send me an email one day and we will catch up.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669168">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669168">31</a> by Corey Christensen
		posted on 4/29/2011 at 11:34 PM
		</div>
		<div class="comment_text"><p>Correct, we are having a problem with our verity collections. We are adding new pdf documents to the verity collections, but verity isn't picking up the new pdfs. We have attempted to repair and even re-create the collection, but that new pdfs aren't being collected. Thats why i was starting to look other routes to resolve this issue. any ideas?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669169">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669169">32</a> by Raymond Camden
		posted on 4/29/2011 at 11:38 PM
		</div>
		<div class="comment_text"><p>Just to be clear, you do know that when you add new PDFs that you have to update the index, right? You can and should also check the status result to ensure that items got inserted or updated.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669173">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669173">33</a> by Corey Christensen
		posted on 4/30/2011 at 12:04 AM
		</div>
		<div class="comment_text"><p>were using action="refresh" which should delete all docs in collection and then add keys to the index. Prob is, its still not picking up newly added files. its been so long since i've used verity...will need to continue troubleshooting</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669171">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669171">34</a> by Raymond Camden
		posted on 4/30/2011 at 12:09 AM
		</div>
		<div class="comment_text"><p>You should check the status result from cfindex. See if it matches the #s you expect.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669170">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669170">35</a> by Corey Christensen
		posted on 5/2/2011 at 8:33 PM
		</div>
		<div class="comment_text"><p>The reason new pdfs weren't being added to the collection was because the user had been upgraded to Acrobat 9.1 and the distiller was saving the pdfs in v1.5 which cfindex doesn't like. fix was <br>1. use cffile to read file contents. <br>2. cfif version gt 1.4; notify user to upload compatible pdf. <br>3. always use the status for cfindex to catch future issues. Thanks so much!</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669174">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669174">36</a> by Raymond Camden
		posted on 5/2/2011 at 8:35 PM
		</div>
		<div class="comment_text"><p>To be clear, this was Verity, right? I assume Solr wouldn't have an issue with 1.5.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669172">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669172">37</a> by Corey Christensen
		posted on 5/2/2011 at 8:38 PM
		</div>
		<div class="comment_text"><p>yes, we are using verity (cf8)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669175">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669175">38</a> by Phil Evans
		posted on 11/21/2011 at 12:41 PM
		</div>
		<div class="comment_text"><p>Brilliant - thanks Ray!</p><p>This has enabled me to do a workaround fix for the problem where cfdocument does not support<br>style="page-break-inside: avoid;"</p><p>It is not overly efficient, in that it recreates the entire report for each instance where<br>a page break needs to be repositioned, but the preliminary testing is good. Others may like to embellish the following.<br>It creates hidden fields in the pdf, formatted as <br>keep_together_start_001, keep_together_end_001, keep_together_start_002, keep_together_end_002 etc<br>If the matching start and end tags are not on the same page, then the pdf is recreated with an appropriate page break prior to the section to be kept together.</p><p>In the style sheet<br>p.hidden { height: 1px; width: 1px; overflow: hidden; top: -10px; margin: 0px;}</p><p>On initialisation of the page that creates the pdf<br>&lt;cfif not isdefined("url.keep_together")&gt;<br>	&lt;cfset session.keep_together_list = ""&gt;<br>&lt;/cfif&gt;<br>&lt;cfset keep_together_count = 0&gt;</p><p>...</p><p>At the start of a section of output that I want kept together, put the following</p><p>		&lt;cfset keep_together_count += 1&gt;<br>		&lt;cfif ListFind(session.keep_together_list,"#NumberFormat(keep_together_count,"000")#","|") gt 0&gt;<br>			&lt;cfdocumentitem type="pagebreak"&gt;&lt;/cfdocumentitem&gt;<br>		&lt;cfelse&gt;<br>			&lt;cfoutput&gt;<br>				&lt;p class="hidden"&gt;keep_together_start_#NumberFormat(keep_together_count,"000")#&lt;/h2&gt;<br>			&lt;/cfoutput&gt;<br>		&lt;/cfif&gt;</p><p>...</p><p>At the end of the section to be kept together</p><p>&lt;cfif ListFind(session.keep_together_list,"#NumberFormat(keep_together_count,"000")#","|") eq 0&gt;<br>	&lt;cfoutput&gt;<br>		&lt;p class="hidden"&gt;keep_together_end_#NumberFormat(keep_together_count,"000")#&lt;/h2&gt;<br>	&lt;/cfoutput&gt;<br>&lt;/cfif&gt;</p><p>Once the PDF file has been created, use Raymond's pdfutils to check each page for a start without a matching end.<br>If found, indicate which section of code need to have a page break inserted before it, and then reproduce the report.</p><p>&lt;!--- Check for keep_togethers that were split ---&gt;<br>&lt;cfset pdf = createObject("component", "pdfutils")&gt;<br>&lt;cfset mypdf = expandPath("my_report.pdf")&gt;<br>&lt;cfset pdf_struct = pdf.getText(mypdf)&gt;</p><p>&lt;cfloop index="idx" from="1" to="#ArrayLen(pdf_struct)#"&gt;<br>	&lt;cfset start_offset = find("keep_together_start_",pdf_struct[idx].text)&gt;<br>	&lt;cfif start_offset neq 0&gt;<br>		&lt;cfset keep_together_id = Mid(pdf_struct[idx].text,start_offset + 20,3)&gt;<br>		&lt;cfset end_offset = findnocase("keep_together_end_#keep_together_id#",pdf_struct[idx].text)&gt;<br>		&lt;cfif end_offset eq 0&gt;<br>			&lt;cfset session.keep_together_list = session.keep_together_list &amp; "|" &amp; keep_together_id&gt;<br>			&lt;cflocation addtoken="No" url="my_report.cfm?keep_together"&gt;<br>		&lt;/cfif&gt;<br>	&lt;/cfif&gt;<br>&lt;/cfloop&gt;</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669176">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669176">39</a> by misty
		posted on 8/26/2012 at 5:02 PM
		</div>
		<div class="comment_text"><p>hi ray, i currently have a pdf where the field shows %firstname% the king, where it can be removed or replaced with another text, i am not sure if that is form inside or what, but i can actually remove it.</p><p>the thing i i waqnt to replace it some name like misty, how and what is the better approach for this</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669179">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669179">40</a> by Raymond Camden
		posted on 8/26/2012 at 6:59 PM
		</div>
		<div class="comment_text"><p>I'd build a HTML template with the tokens. You can then use CF string functions to replace the tokens and pass it to cfdocument to create the PDF.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669177">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669177">41</a> by Lee Wissmiller
		posted on 4/11/2013 at 12:06 AM
		</div>
		<div class="comment_text"><p>I am working on a search engine for a website, and I noticed your code would create an array of the PDF files. I would like to modify and expand on this code to search any newly posted PDF files at a set scheduled time (hourly, daily etc) and store the results in a database, then I can use SQL to search the database and return result to the users. What do you think of something like this as a simple PDF search engine for a website?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669178">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669178">42</a> by Raymond Camden
		posted on 4/11/2013 at 1:33 AM
		</div>
		<div class="comment_text"><p>Unless I'm misunderstanding you, couldn't you just take the array my stuff returns, iterate over it, and do db inserts? Or if you want to insert all the text, just arrayToList it with a " " delimiter to get one big blog.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669180">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669180">43</a> by Raymond Camden
		posted on 4/11/2013 at 1:33 AM
		</div>
		<div class="comment_text"><p>"one big blob" I meant.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669182">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669182">44</a> by Chris
		posted on 6/5/2013 at 7:45 PM
		</div>
		<div class="comment_text"><p>Hi Ray, have you run into an issue parsing certain PDFs that are in landscape orientation?  A department receives a large monthly billing PDF that contain an employee name, department number, etc.  I'm trying to pull out this information to automate splitting the PDF and emailing the relevant pages to each employee.  But when I try using either your example or the read action of the CFPDF tag, the data returned is jumbled... like it's trying to parse the PDF as if it was in portrait orientation, moving from top to bottom.  Have you seen this before?  I have no problems with other PDFs in portrait format.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669183">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669183">45</a> by Raymond Camden
		posted on 6/6/2013 at 12:16 PM
		</div>
		<div class="comment_text"><p>I have seen this - or something similar. My understanding, and this is NOT scientific, is that when a PDF has text in a "non straight top to bottom" format, the text will be jumbled. I think this kind of makes sense. I mean humans can look at something like an invoice and mentally grok the right way to parse the text, but a computer cannot. As far as I know, there isn't anything you can do about this. (But again, I could be wrong.)</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669181">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669181">46</a> by Chris
		posted on 6/6/2013 at 6:02 PM
		</div>
		<div class="comment_text"><p>Opps, I meant to say other landscaped PDFs parse fine in my post above.</p><p>This is the only report I'm dealing with that is generated by some software called DocumentBurster, so it must be something screwy that software is doing to the report that CF can't understand.</p><p>If I figure it out, I'll post back as I haven't found anyone else having this issue in my searches.  Thanks Ray.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669184">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669184">47</a> by Eric
		posted on 11/7/2013 at 9:15 PM
		</div>
		<div class="comment_text"><p>How do you use the  cfdump to dump the results of the PDF text to a database table?</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669185">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669185">48</a> by Raymond Camden
		posted on 11/7/2013 at 9:16 PM
		</div>
		<div class="comment_text"><p>You don't. CFDUMP is a debugging tool. Instead of cfdumping the variable, you would use it in a cfquery statement using an INSERT statement.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669186">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669186">49</a> by Eric
		posted on 11/7/2013 at 9:25 PM
		</div>
		<div class="comment_text"><p>I did this</p><p>&lt;cfset pdf = createObject("component", "pdfutils")&gt;</p><p>&lt;cfset mypdf = expandPath("PSIAppendices.pdf")&gt;</p><p>&lt;cfset results = pdf.getText(mypdf)&gt;</p><p>&lt;!---&lt;cfdump var="#results#"&gt;---&gt;</p><p>&lt;cfquery datasource="xx" name="ins"&gt;<br>INSERT INTO [raw_data]<br>(data_value)<br>VALUES<br>(#pdf.getText(mypdf)#)<br>&lt;/cfquery&gt;</p><p>got this</p><p>Complex object types cannot be converted to simple values.</p><p>The expression has requested a variable or an intermediate expression result as a simple value. However, the result cannot be converted to a simple value. Simple values are strings, numbers, boolean values, and date/time values. Queries, arrays, and COM objects are examples of complex values.<br>The most likely cause of the error is that you tried to use a complex value as a simple one. For example, you tried to use a query variable in a cfif tag.</p><p> The error occurred in C:\ColdFusion9\wwwroot\wrestleworx\testpdfread.cfm: line 14<br>12 : (data_value)<br>13 : VALUES<br>14 : (#pdf.getText(mypdf)#)<br>15 : &lt;/cfquery&gt;<br>16 :</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669189">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669189">50</a> by Raymond Camden
		posted on 11/7/2013 at 9:29 PM
		</div>
		<div class="comment_text"><p>Sorry - if you look above, you can see it is an array of strings. If you want to insert all the text, you need to convert the array into a string. The simplest way would be to use arrayToList with " " as a delimiter.</p></div>
	</div>
</div>
		
<div class="comment" id="c_1713669188">
	<div>
		<img src="//a.disquscdn.com/1611874952/images/noavatar32.png" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_1713669188">51</a> by Eric
		posted on 11/7/2013 at 9:32 PM
		</div>
		<div class="comment_text"><p>Ok, I have never worked with arrays before so I will give it a try</p></div>
	</div>
</div>
		
<div class="comment" id="c_2657789618">
	<div>
		<img src="https://disqus.com/api/users/avatars/patrickjdalton.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_2657789618">52</a> by Skiff Blankenship
		posted on 5/4/2016 at 2:07 PM
		</div>
		<div class="comment_text"><p>"Download attached file" throws a 404 error.</p></div>
	</div>
</div>
		
<div class="comment" id="c_2657814590">
	<div>
		<img src="https://disqus.com/api/users/avatars/cfjedimaster.jpg" class="comment_author_profile_pic">
	</div>
	<div>
		<div class="comment_header">
		Comment <a href="#c_2657814590">53</a> (In reply to <a href="#c_2657789618">#52</a>) by Raymond Camden
		posted on 5/4/2016 at 2:22 PM
		</div>
		<div class="comment_text"><p>You should be able to find it at <a href="https://disq.us/url?url=https%3A%2F%2Fstatic.raymondcamden.com%2Fenclosures%2FArchive7.zip%3A_oW1LKqsY6adW33mcsc1bV5gVCU&amp;cuid=3321886" rel="nofollow noopener" title="https://static.raymondcamden.com/enclosures/Archive7.zip">https://static.raymondcamde...</a>. The link will be fixed the next time I update the site.</p></div>
	</div>
</div>
		